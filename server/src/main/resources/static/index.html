<!DOCTYPE html>
<html>
<head>
	<title>WebSocket Stomp Receiving Example</title>
</head>
<body>

Hello my friend! Yo mama asdf


<div>
	<h3>Messages:</h3>
	<ol id="messages"></ol>
</div>

<script type="text/javascript" src="//cdn.jsdelivr.net/jquery/1.11.2/jquery.min.js"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>

<script type="text/javascript">
	$(document).ready(function () {
		var messageList = $("#messages");

		// defined a connection to a new socket endpoint
		var socket = new SockJS('/stomp');

		var stompClient = Stomp.over(socket);

		stompClient.connect({}, function (frame) {
			// subscribe to the /topic/message endpoint
			stompClient.subscribe("/topic/message", function (data) {
				var message = JSON.parse(data.body);
                messageList.empty();
                $("<img/>", {
                    src: "data:image/svg+xml;base64," + btoa(message.barcodeContent),
					width: "500"
                }).appendTo($("<li/>").appendTo(messageList));

				//messageList.append("<li>" + message.date + "</li>");
			});
		});
	});
</script>
</body>
</html>